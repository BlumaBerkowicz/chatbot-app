<div class="chat-page">
  <div class="animated-background"></div>
  
  <div class="chat-container">
    <p-card>
      <ng-template pTemplate="header">
        <div class="chat-header">
          <div class="header-content">
            <p-avatar icon="pi pi-comments" size="large" [style]="{'background-color': '#2196F3', 'color': '#ffffff'}"></p-avatar>
            <div class="header-text">
              <h2>AI Chat Assistant</h2>
              <span class="subtitle">Ask me anything!</span>
            </div>
          </div>
        </div>
      </ng-template>

      <div class="messages-container" #chatContainer>
        @for (message of messages; track message.timestamp) {
          <div class="message-wrapper" [class.user-message]="message.isUser">
            <div class="message" [class.error-message]="message.isError">
              <p-avatar [icon]="message.isUser ? 'pi pi-user' : 'pi pi-android'" 
                       [style]="{'background-color': message.isUser ? '#4CAF50' : '#2196F3'}"
                       size="normal">
              </p-avatar>
              <div class="message-content">
                <div class="text">{{ message.content }}</div>
                <div class="timestamp">{{ message.timestamp | date:'short' }}</div>
              </div>
            </div>
          </div>
        }
        
        @if (isLoading) {
          <div class="loading-wrapper">
            <p-progressSpinner [style]="{'width': '50px', 'height': '50px'}"></p-progressSpinner>
          </div>
        }
      </div>

      <ng-template pTemplate="footer">
        <div class="input-container">
          <span class="p-input-icon-right p-float-label flex-grow-1">
            <i class="pi pi-send" (click)="sendMessage()" [class.clickable]="newMessage.trim()"></i>
            <input type="text" pInputText 
                   [(ngModel)]="newMessage" 
                   (keyup.enter)="sendMessage()"
                   [disabled]="isLoading"
                   id="message-input"
                   class="w-full">
            <label for="message-input">Type your message</label>
          </span>
          <p-button icon="pi pi-send" 
                    (onClick)="sendMessage()" 
                    [disabled]="!newMessage.trim() || isLoading"
                    styleClass="p-button-rounded p-button-primary"
                    pRipple>
          </p-button>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>
